{"version":3,"file":"ng-simple-carousel.js","sources":["../../../projects/ng-simple-carousel/src/lib/carousel.component.ts","../../../projects/ng-simple-carousel/src/lib/carousel.controller.ts","../../../projects/ng-simple-carousel/src/lib/with-button/with-button.component.ts","../../../projects/ng-simple-carousel/src/lib/with-dots/with-dots.component.ts","../../../projects/ng-simple-carousel/src/lib/carousel.module.ts","../../../projects/ng-simple-carousel/src/public-api.ts","../../../projects/ng-simple-carousel/src/ng-simple-carousel.ts"],"sourcesContent":["/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AfterViewInit, Component, ElementRef, EventEmitter, Input, OnDestroy, OnInit, Output, ViewChild } from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { CarouselController } from './carousel.controller';\n\nexport interface CarouselImage {\n  id: string;\n  src: string;\n  alt?: string;\n  /**\n   * [For Responsive Image]{@link https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images}\n   */\n  srcset?: string;\n  /**\n   * [For Responsive Image]{@link https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images}\n   */\n  sizes?: string;\n  sources?: CarouselImageSource[];\n}\n\n/**\n * [For source in picture element]{@link https://developer.mozilla.org/ja/docs/Web/HTML/Element/picture}\n */\nexport interface CarouselImageSource {\n  srcset: string;\n  type?: string;\n  sizes?: string;\n}\n\n@Component({\n  selector: 'ng-simple-carousel',\n  templateUrl: './carousel.html',\n  styleUrls: ['./carousel.scss']\n})\nexport class NgSimpleCarouselComponent implements OnInit, OnDestroy, AfterViewInit {\n  @ViewChild('container') containerEl: ElementRef;\n  @Input() controller: CarouselController;\n  @Input() images: CarouselImage[];\n  @Input() objectFit: 'contain' | 'cover' = 'contain';\n  // @Input() infinite = false;\n  @Output() imgChange: EventEmitter<string> = new EventEmitter();\n  activeIndex = 0;\n  observer: IntersectionObserver;\n  scroll$ = new BehaviorSubject(false);\n  destroy$ = new Subject<void>();\n\n  constructor() { }\n\n  ngOnInit(): void {\n    this.controller.jump$.pipe(takeUntil(this.destroy$)).subscribe(id => this.jumpTo(id));\n    this.controller.action$.pipe(takeUntil(this.destroy$)).subscribe(action => action === 'prev' ? this.onPrev() : this.onNext());\n  }\n\n  ngAfterViewInit() {\n    this.initObserve();\n    this.startObserve();\n  }\n\n  initObserve() {\n    const rootEl = this.containerEl.nativeElement as HTMLElement;\n    const options = {\n      root: rootEl,\n      rootMargin: '0px -50%',\n    };\n    this.observer = new IntersectionObserver((entries, observer) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) {\n          const activeId = entry.target.id;\n          const newInd = this.images.findIndex(img => img.id === activeId)\n          this.onImgChange(activeId, newInd);\n        }\n      });\n    }, options);\n  }\n\n  startObserve() {\n    const rootEl = this.containerEl.nativeElement as HTMLElement;\n    Array.from(rootEl.children).forEach(img => this.observer.observe(img));\n  }\n\n  stopObserve() {\n    this.observer.disconnect();\n  }\n\n  // Observer will call onImgChange()\n  jumpTo(id: string) {\n    const newInd = this.images.findIndex(img => img.id === id);\n    if (this.activeIndex === newInd) { return; }\n    const rootEl = this.containerEl.nativeElement as HTMLElement;\n    rootEl.scrollTo({\n      top: 0,\n      left: rootEl.offsetWidth * newInd,\n      behavior: 'smooth'\n    });\n  }\n\n  onPrev() {\n    let newId;\n    if (this.activeIndex - 1 >= 0) { newId = this.images[this.activeIndex - 1].id; }\n    // if (this.infinite && this.activeIndex - 1 < 0) { newId = this.images[this.images.length - 1].id; }\n    if (newId) { this.jumpTo(newId); }\n  }\n\n  onNext() {\n    let newId;\n    if (this.activeIndex + 1 < this.images.length) { newId = this.images[this.activeIndex + 1].id; }\n    // if (this.infinite && this.activeIndex + 1 > this.images.length - 1) { newId = this.images[0].id; }\n    if (newId) { this.jumpTo(newId); }\n  }\n\n  onImgChange(id: string, index: number) {\n    if (this.activeIndex === index) { return; }\n    this.activeIndex = index;\n    this.imgChange.emit(id);\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n    this.stopObserve();\n  }\n\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Subject } from \"rxjs\";\n\nexport class CarouselController {\n  private jumpSub: Subject<string> = new Subject<string>();\n  jump$ = this.jumpSub.asObservable();\n  private actionSub: Subject<'prev' | 'next'> = new Subject<'prev' | 'next'>();\n  action$ = this.actionSub.asObservable();\n\n  constructor() {\n  }\n\n  jumpTo(id: string) {\n    this.jumpSub.next(id);\n  }\n\n  prev() {\n    this.actionSub.next('prev');\n  }\n\n  next() {\n    this.actionSub.next('next');\n  }\n\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { CarouselImage } from './../carousel.component';\nimport { CarouselController } from './../carousel.controller';\n\n@Component({\n  selector: 'ng-simple-carousel-with-button',\n  templateUrl: './with-button.component.html',\n  styleUrls: ['./with-button.component.scss']\n})\nexport class NgSimpleCarouselWithButtonComponent implements OnInit {\n  @Input() controller: CarouselController;\n  @Input() images: CarouselImage[];\n  @Input() objectFit: 'contain' | 'cover';\n  // @Input() infinite = false;\n  @Output() imgChange: EventEmitter<string> = new EventEmitter();\n  isFirstImg = true;\n  isLastImg = false;\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n  onPrev() {\n    this.controller.prev();\n  }\n\n  onNext() {\n    this.controller.next();\n  }\n\n  onImgChange(id: string) {\n    if (id === this.images[0].id) {\n      this.isFirstImg = true;\n      this.isLastImg = false;\n    } else if (id === this.images[this.images.length - 1].id) {\n      this.isFirstImg = false;\n      this.isLastImg = true;\n    } else {\n      this.isFirstImg = false;\n      this.isLastImg = false;\n    }\n    this.imgChange.emit(id);\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { CarouselImage } from './../carousel.component';\nimport { CarouselController } from './../carousel.controller';\n\n@Component({\n  selector: 'ng-simple-carousel-with-dots',\n  templateUrl: './with-dots.component.html',\n  styleUrls: ['./with-dots.component.scss']\n})\nexport class NgSimpleCarouselWithDotsComponent implements OnInit {\n  @Input() controller: CarouselController;\n  @Input() images: CarouselImage[];\n  @Input() objectFit: 'contain' | 'cover';\n  // @Input() infinite = false;\n  @Output() imgChange: EventEmitter<string> = new EventEmitter();\n  activeId;\n\n  constructor() { }\n\n  ngOnInit(): void {\n    this.activeId = this.images[0].id;\n  }\n\n  onImgChange(id: string) {\n    this.activeId = id;\n    this.imgChange.emit(id);\n  }\n\n  onDotsClick(id: string) {\n    this.controller.jumpTo(id);\n  }\n}\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { NgSimpleCarouselComponent } from './carousel.component';\nimport { NgSimpleCarouselWithButtonComponent } from './with-button/with-button.component';\nimport { NgSimpleCarouselWithDotsComponent } from './with-dots/with-dots.component';\n\n@NgModule({\n  declarations: [NgSimpleCarouselComponent, NgSimpleCarouselWithButtonComponent, NgSimpleCarouselWithDotsComponent],\n  imports: [\n    CommonModule\n  ],\n  exports: [NgSimpleCarouselComponent, NgSimpleCarouselWithButtonComponent, NgSimpleCarouselWithDotsComponent]\n})\nexport class NgSimpleCarouselModule { }\n","/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*\n * Public API Surface of ng-simple-carousel\n */\n\nexport * from './lib/carousel.component';\nexport * from './lib/carousel.controller';\nexport * from './lib/carousel.module';\n\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {NgSimpleCarouselWithButtonComponent as ɵa} from './lib/with-button/with-button.component';\nexport {NgSimpleCarouselWithDotsComponent as ɵb} from './lib/with-dots/with-dots.component';"],"names":[],"mappings":"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"}